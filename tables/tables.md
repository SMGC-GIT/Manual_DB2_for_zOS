# üõ†Ô∏è Caderno de Boas Pr√°ticas: DB2 for z/OS ‚Äì Tabelas

Este documento re√∫ne boas pr√°ticas para a cria√ß√£o e manuten√ß√£o de **tabelas no DB2 for z/OS**, com foco no papel do DBA de desenvolvimento. Cada item cont√©m explica√ß√µes abrangentes com base em documenta√ß√£o oficial da IBM, al√©m de recomenda√ß√µes pr√°ticas para garantir desempenho, manutenibilidade e integridade dos dados.

---

## üìÅ 1. Nomenclatura de Tabelas e Colunas

> **Objetivo**: Garantir clareza, consist√™ncia e facilitar manuten√ß√£o futura.

### ‚úÖ Boas Pr√°ticas

- Use nomes **significativos e autoexplicativos**.
  - Exemplo: `CLIENTE`, `ENDERECO`, `PEDIDO_ITEM`.
- Utilize o **padr√£o UPPER_SNAKE_CASE** para maior legibilidade em ambientes mainframe.
- Prefixe tabelas por dom√≠nio, se necess√°rio:
  - Exemplo: `CAD_CLIENTE`, `VEN_PEDIDO`.

### ‚ùó Evite
- Abrevia√ß√µes excessivas: `CLNT`, `ADR`.
- Termos gen√©ricos: `DATA`, `INFO`, `REGISTRO`.

---

## üìå 2. Tipos de Dados

> **Objetivo**: Otimizar o uso de espa√ßo e melhorar a performance em opera√ß√µes de I/O.

### ‚úÖ Boas Pr√°ticas

- Use tipos de dados apropriados:
  - `SMALLINT`, `INTEGER`, `BIGINT`: escolha conforme a faixa de valores esperada.
  - `DECIMAL(p,s)` para valores monet√°rios.
  - `DATE`, `TIME`, `TIMESTAMP` para dados temporais.
- Use `VARCHAR` para colunas de texto vari√°vel (ex: descri√ß√£o, observa√ß√£o).
- Evite `CHAR` fixo para campos de comprimento vari√°vel.

### ‚ùó Evite
- Usar `VARCHAR(1000)` quando o campo normalmente tem 50 caracteres.
- Definir campos num√©ricos como `CHAR`.

---

## üîê 3. Chave Prim√°ria (PRIMARY KEY)

> **Objetivo**: Garantir unicidade e identidade da entidade representada.

### ‚úÖ Boas Pr√°ticas

- Escolha colunas **imut√°veis e est√°veis** como chave prim√°ria.
- Quando necess√°rio, use chaves artificiais (`ID`) com `GENERATED BY DEFAULT AS IDENTITY`.
- Prefira `INTEGER` ou `BIGINT` como tipo de chave artificial.

### ‚ùó Evite
- Usar campos mut√°veis (como `EMAIL`) como chave prim√°ria.
- Chaves compostas complexas que dificultam jun√ß√µes.

---

## üîó 4. Chave Estrangeira (FOREIGN KEY)

> **Objetivo**: Assegurar integridade referencial entre tabelas.

### ‚úÖ Boas Pr√°ticas

- Sempre defina `FOREIGN KEY` com `ON DELETE` e `ON UPDATE` explicitamente definidos:
  - `ON DELETE RESTRICT`, `ON DELETE CASCADE`, etc.
- Crie **√≠ndices** nas colunas de `FOREIGN KEY` para melhorar performance em jun√ß√µes.

### ‚ùó Evite
- Permitir chaves √≥rf√£s omitindo a `FOREIGN KEY`.
- Deixar a√ß√µes default que n√£o sejam as esperadas (`NO ACTION`).

---

## üì¶ 5. Constraints (CHECK, NOT NULL, DEFAULT)

> **Objetivo**: Prevenir erros de integridade e facilitar valida√ß√£o dos dados.

### ‚úÖ Boas Pr√°ticas

- Use `NOT NULL` sempre que o campo for obrigat√≥rio.
- Defina `DEFAULT` em campos como datas ou status:
  - Ex: `STATUS DEFAULT 'ATIVO'`, `DATA_CADASTRO DEFAULT CURRENT DATE`.
- Use `CHECK` para regras de neg√≥cio simples:
  - Ex: `CHECK (IDADE >= 18)`.

### ‚ùó Evite
- Permitir valores nulos onde n√£o fazem sentido.
- Deixar regras de valida√ß√£o apenas no c√≥digo da aplica√ß√£o.

---

## üöÄ 6. Indexa√ß√£o

> **Objetivo**: Melhorar performance de leitura, jun√ß√µes e buscas.

### ‚úÖ Boas Pr√°ticas

- Sempre crie √≠ndice para:
  - Chave prim√°ria.
  - Chave estrangeira.
  - Colunas frequentemente utilizadas em cl√°usulas `WHERE`, `JOIN`, `ORDER BY`.
- Nomeie √≠ndices com padr√£o: `IDX_<TABELA>_<COLUNA>`.

### ‚ùó Evite
- Criar muitos √≠ndices que nunca s√£o usados.
- Indexar colunas com alta cardinalidade e baixa seletividade sem necessidade.

---

## üìä 7. Tabelas Tempor√°rias

> **Objetivo**: Apoiar processos de ETL, relat√≥rios e opera√ß√µes intermedi√°rias.

### ‚úÖ Boas Pr√°ticas

- Use **declared global temporary tables (DGTT)** para processamento tempor√°rio.
- Defina com `ON COMMIT PRESERVE ROWS` se os dados precisarem ser mantidos entre commits.

### ‚ùó Evite
- Usar tabelas permanentes como tempor√°rias.
- Esquecer de limpar os dados tempor√°rios ap√≥s uso.

---

### üìÑ 8. Coment√°rios (DOCUMENTA√á√ÉO)

> **Objetivo**: Facilitar manuten√ß√£o e transfer√™ncias de conhecimento.

#### ‚úÖ Boas Pr√°ticas

- Documente tabelas e colunas com `LABEL` e `COMMENT ON`:
  ```sql
  COMMENT ON TABLE CLIENTE IS 'Tabela com dados cadastrais de clientes';
  COMMENT ON COLUMN CLIENTE.NOME IS 'Nome completo do cliente';
  ```
- Inclua defini√ß√µes de neg√≥cios nos coment√°rios sempre que poss√≠vel.
- Padronize coment√°rios: evite misturar portugu√™s e ingl√™s na mesma base.
- Comente tamb√©m rotinas, views e stored procedures cr√≠ticas.

#### ‚ùó Evite

- Omiss√£o completa de documenta√ß√£o.
- Coment√°rios gen√©ricos como ‚Äúcoluna 1‚Äù ou ‚Äúdado‚Äù.
- Deixar coment√°rios desatualizados ap√≥s mudan√ßas no schema.

---

### üßæ 9. Particionamento (Table Partitioning)

> **Objetivo**: Melhorar gerenciamento e performance em grandes volumes de dados.

#### ‚úÖ Boas Pr√°ticas

- Utilize particionamento por:
  - `RANGE` (intervalos de valores, como datas)
  - `LIST` (valores discretos, como regi√µes)
- Divida grandes tabelas por per√≠odos (ex: m√™s, ano) ou tipos de dados.
- Melhore o desempenho de consultas massivas e manuten√ß√£o de hist√≥rico.
- Habilite `ROLLING REORG` com particionamento para reorganiza√ß√µes parciais.

#### ‚ùó Evite

- Usar particionamento sem an√°lise detalhada do volume e padr√£o de acesso.
- Criar muitas parti√ß√µes em tabelas pequenas ou sem necessidade real.
- Deixar parti√ß√µes antigas sem gerenciamento de dados inativos.

---

### üß¨ 10. Normaliza√ß√£o e Desnormaliza√ß√£o

> **Objetivo**: Equilibrar integridade dos dados com desempenho, conforme o caso.

#### ‚úÖ Boas Pr√°ticas

- Normalize tabelas at√© a 3¬™ forma normal em sistemas OLTP:
  - Elimine redund√¢ncias.
  - Garanta integridade referencial.
- Em ambientes anal√≠ticos (OLAP), considere desnormalizar para performance:
  - Menos joins complexos.
  - Consultas mais r√°pidas com dados agrupados.
- Documente quando houver desnormaliza√ß√£o proposital.

#### ‚ùó Evite

- Redund√¢ncia de dados sem controle.
- Criar joins desnecess√°rios por excesso de normaliza√ß√£o.
- Aplicar as mesmas regras a OLTP e OLAP sem considerar as diferen√ßas.

---

### üìò Refer√™ncias

- [IBM Knowledge Center ‚Äì DB2 for z/OS Documentation](https://www.ibm.com/docs/en/db2-for-zos)
- [IBM Redbooks ‚Äì DB2 12 for z/OS Introduction and New Features](https://www.redbooks.ibm.com/abstracts/sg248363.html)

